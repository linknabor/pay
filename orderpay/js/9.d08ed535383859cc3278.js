webpackJsonp([9],{Rsbi:function(t,e){},dfC0:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("pFYg"),a=i.n(s),n=i("7+uW");function o(t,e,i){var s=this;this.obj=t,this.binding=e,this.touchType=i,this.vueTouches={x:0,y:0},this.vueMoves=!0,this.vueLeave=!0,this.longTouch=!0,this.vueCallBack="object"==a()(e.value)?e.value.fn:e.value,this.obj.addEventListener("touchstart",function(t){s.start(t)},!1),this.obj.addEventListener("touchend",function(t){t.preventDefault(),s.end(t)},!1),this.obj.addEventListener("touchmove",function(t){s.move(t)},!1)}o.prototype={start:function(t){this.vueMoves=!0,this.vueLeave=!0,this.longTouch=!0,this.vueTouches={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY},this.time=setTimeout(function(){this.vueLeave&&this.vueMoves&&("longtap"==this.touchType&&this.vueCallBack(this.binding.value,t),this.longTouch=!1)}.bind(this),1e3)},end:function(t){var e=t.changedTouches[0].pageX-this.vueTouches.x,i=t.changedTouches[0].pageY-this.vueTouches.y;clearTimeout(this.time),Math.abs(e)>10||Math.abs(i)>100?("swipe"==this.touchType&&this.vueCallBack(this.binding.value,t),Math.abs(e)>Math.abs(i)?(e>10&&"swiperight"==this.touchType&&this.vueCallBack(this.binding.value,t),e<-10&&"swipeleft"==this.touchType&&this.vueCallBack(this.binding.value,t)):(i>10&&"swipedown"==this.touchType&&this.vueCallBack(this.binding.value,t),i<-10&&"swipeup"==this.touchType&&this.vueCallBack(this.binding.value,t))):this.longTouch&&this.vueMoves&&("tap"==this.touchType&&this.vueCallBack(this.binding.value,t),this.vueLeave=!1)},move:function(t){this.vueMoves=!1}},n.default.directive("tap",{bind:function(t,e){new o(t,e,"tap")}});var c=i("fxnj"),r=i.n(c),l=void 0,h={data:function(){return{commentQuality:5,commentAttitude:5,commentService:5,comment:"",photos:[],uploadImgMap:{}}},created:function(){l=this;var t=location.href.split("#")[0];l.receiveData.wxconfig(l,r.a,["chooseImage","previewImage","uploadImage","downloadImage"],t)},mounted:function(){},computed:{itemClasses:function(){for(var t=[],e=Math.floor(2*this.commentQuality)/2,i=Math.floor(e),s=0;s<i;s++)t.push("on");for(;t.length<5;)t.push("off");return t},itemClasses1:function(){for(var t=[],e=Math.floor(2*this.commentAttitude)/2,i=Math.floor(e),s=0;s<i;s++)t.push("on");for(;t.length<5;)t.push("off");return t},itemClasses2:function(){for(var t=[],e=Math.floor(2*this.commentService)/2,i=Math.floor(e),s=0;s<i;s++)t.push("on");for(;t.length<5;)t.push("off");return t}},methods:{getUrlParam:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null},serverClick:function(t){l.commentQuality=t+1},serverClick1:function(t){l.commentAttitude=t+1},serverClick2:function(t){l.commentService=t+1},focus:function(){},storeComment:function(t){l.comment=t.srcElement.innerText},addPic:function(){r.a.chooseImage({count:6,sizeType:["compressed"],sourceType:["album","camera"],success:function(t){var e=t.localIds;if(0==e.length)return alert("未获取图片，请刷新后重新选择图片。"),!1;for(var i=0;i<e.length;i++){if(6==l.photos.length){alert("最多只能上传6张图片");break}var s={imgUrl:e[i]};l.photos.push(s),l.uploadImg(e[i])}}})},uploadImg:function(t){r.a.uploadImage({localId:t,isShowProgressTips:1,success:function(e){l.uploadImgMap[t]=e.serverId}})},submit:function(){""==l.comment||l.comment.length<5?alert("评论字数不能小于5个！"):l.comment.length>400?alert("评论字数不能大于400！"):l.sendComment()},sendComment:function(){var t="";for(var e in l.uploadImgMap)t+=l.uploadImgMap[e]+",";var i={repairId:l.$route.query.ordersID,commentQuality:l.commentQuality,commentAttitude:l.commentAttitude,commentService:l.commentService,comment:l.comment,commentImgUrls:t};l.receiveData.postData(l,"/repair/comment",i,"res",function(){if(l.res.success){var t=l.getUrlParam("oriApp")?"oriApp="+l.getUrlParam("oriApp"):"";window.location.href=l.basePageUrl+"person/index.html?"+t+"#/ordersDetail?orderId="+l.$route.query.ordersID}else alert("评论失败，请稍后重试！")})}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("div",{staticStyle:{"line-height":"35px"}},[i("span",{staticClass:"grade fs15"},[t._v("维修质量：")]),t._v(" "),i("span",{staticStyle:{float:"right","margin-right":"10px"}},t._l(t.itemClasses,function(e,s){return i("div",{staticClass:"star",class:e,on:{click:function(e){t.serverClick(s)}}})}))]),t._v(" "),i("div",{staticStyle:{"line-height":"35px"}},[i("span",{staticClass:"grade fs15"},[t._v("服务态度：")]),t._v(" "),i("span",{staticStyle:{float:"right","margin-right":"10px"}},t._l(t.itemClasses1,function(e,s){return i("div",{staticClass:"star",class:e,on:{click:function(e){t.serverClick1(s)}}})}))]),t._v(" "),i("div",{staticStyle:{"line-height":"35px"}},[i("span",{staticClass:"grade fs15"},[t._v("服务效率：")]),t._v(" "),i("span",{staticStyle:{float:"right","margin-right":"10px"}},t._l(t.itemClasses2,function(e,s){return i("div",{staticClass:"star",class:e,on:{click:function(e){t.serverClick2(s)}}})}))]),t._v(" "),i("div",{staticClass:"content p15 fs15",class:{hasvalue:t.comment},staticStyle:{"line-height":"20px"},attrs:{contenteditable:""},on:{click:t.focus,blur:t.storeComment}}),t._v(" "),i("div",{staticClass:"photo_area"},[i("div",{staticStyle:{"margin-top":"15px",width:"100%",height:"35px"}},[i("div",{staticStyle:{float:"left","padding-left":"5px"}},[t._v("上传照片")]),t._v(" "),i("div",{staticStyle:{float:"right","padding-right":"15px",color:"#999"}},[t._v(t._s(t.photos.length)+"/6")])]),t._v(" "),t._l(t.photos,function(t){return i("div",{staticClass:"photo_wrap a_third_m20_height"},[i("img",{staticClass:"photo a_third_m22_height",attrs:{src:t.imgUrl}})])}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.photos.length<6,expression:"photos.length<6"}],staticClass:"photo_wrap a_third_m20_height",on:{click:t.addPic}},[i("div",{staticClass:"photo addicon a_third_m22_height",staticStyle:{"margin-left":"4px","margin-right":"2px",outline:"#e5e2dd solid 1px"}})])],2),t._v(" "),i("div",{staticStyle:{clear:"both"}}),t._v(" "),i("div",{staticStyle:{width:"100%",height:"60px"}},[t._v(" ")]),t._v(" "),i("div",{staticClass:"btn-fixed"},[i("div",{directives:[{name:"tap",rawName:"v-tap",value:{fn:t.submit},expression:"{fn:submit}"}],staticClass:"btn"},[t._v("发表评论")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title_area"},[e("div",{staticClass:"brand-tip-1"},[this._v("支付成功")]),this._v(" "),e("div",{staticClass:"brand-tip-2"},[this._v("维修工师傅很辛苦，给个好评呗")])])}]};var v=i("VU/8")(h,u,!1,function(t){i("Rsbi")},"data-v-3a1db29c",null);e.default=v.exports}});