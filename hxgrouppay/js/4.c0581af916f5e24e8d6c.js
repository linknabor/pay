webpackJsonp([4],{dGfM:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=s("bOdI"),i=s.n(r),c=s("fxnj"),n=s.n(c),d=s("lbHh"),o=s.n(d),u=void 0,l=(a={data:function(){return{zzshow:!1,ruleId:this.$route.query.ruleId,type:this.$route.query.type,product:{},rule:{limitNumOnce:10,price:0},address:{},checkedAddress:{},count:1,totalAmount:0,order:{}}},watch:{},created:function(){u=this},mounted:function(){u.roady()},components:{}},i()(a,"watch",{}),i()(a,"methods",{roady:function(){u.ruleId&&u.type&&u.queryBuyInfo()},initSession4Test:function(){u.receiveData.getData(u,"/initSession4Test/105","Data",function(){})},queryBuyInfo:function(){u.receiveData.getData(u,"/queryBuyInfo/"+u.type+"/"+u.ruleId,"res",function(){u.res.success?(u.product=u.res.result.product,u.rule=u.res.result.rule,u.res.result.address&&(u.checkedAddress=u.res.result.address),u.computeAmount()):alert("订单处理中，请稍后再试！")})},computeAmount:function(){var e;e=u.rule.price*u.count+(u.count<u.rule.freeShippingNum?u.rule.postageFee:0),u.totalAmount=e>0?e.toFixed(2):"0.01"},pay:function(){var e={ruleId:u.ruleId,count:u.count,orderType:"12",serviceAddressId:u.checkedAddress.id,payType:"2"},t=o.a.get("sectId");if(""==t||"null"==t||0==t||null==t)return alert("您暂未绑定房屋，请前往“我是业主”进行操作，感谢！"),location.href=u.basePageUrl+"wuye/index.html?"+u.common.getoriApp()+"#/myhouse",!1;u.zzshow=!0,u.receiveData.postData(u,"/createOrder",e,"n",function(){u.n.success?(u.order=u.n.result,u.requestPay()):alert(null==u.n.message?"订单创建失败，请稍后重试！":u.n.message)})},requestPay:function(){u.receiveData.getData(u,"/requestPay/"+u.order.id,"n",function(){u.n.success?(n.a.config({debug:!1,appId:u.n.result.appId,timestamp:u.n.result.timestamp,nonceStr:u.n.result.nonceStr,signature:u.n.result.signature,jsApiList:["chooseWXPay"]}),n.a.chooseWXPay({timestamp:u.n.result.timestamp,nonceStr:u.n.result.nonceStr,package:u.n.result.pkgStr,signType:u.n.result.signType,paySign:u.n.result.signature,success:function(e){u.notifyPaySuccess()},cancel:function(e){alert("支付取消"),u.zzshow=!1}})):(alert(null==u.n.message?"支付请求失败，请稍后重试！":u.n.message),u.zzshow=!1)})},notifyPaySuccess:function(){var e="notifyPayed/"+u.order.id;u.receiveData.getData(u,e,"res",function(){u.res.success?(alert("下单成功！"),u.$router.push({path:"/cardrollsuccess",query:{orderId:u.order.id,type:u.type}})):(u.zzshow=!1,alert(u.res.message))})},cancelPay:function(){u.receiveData.getData(u,"/order/cancelRequestPay/"+u.order.id,"res",function(){u.res.success||alert(u.res.message)})}}),i()(a,"computed",{}),a),v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"buy"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"load6",attrs:{id:"LoadingBar"}},[s("div",{staticClass:"bounce1"}),e._v(" "),s("div",{staticClass:"bounce2"}),e._v(" "),s("div",{staticClass:"bounce3"})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"black_overlay",attrs:{id:"fade"}}),e._v(" "),s("div",{staticClass:"zhi"},[s("div",{staticStyle:{background:"white",height:"15px",width:"100%"}},[e._v(" ")]),e._v(" "),s("div",{staticClass:"addr_area"},[s("div",{staticClass:"addr-top"},[e._v(" ")]),e._v(" "),e.checkedAddress.receiveName?s("div",{staticClass:"menu-link fs14 addr_detail"},[s("span",{staticStyle:{color:"#3b3937"},attrs:{id:"infoname"}},[e._v(e._s(e.checkedAddress.receiveName))]),e._v(" "),s("span",{staticStyle:{"margin-left":"15px",color:"#3b3937"},attrs:{id:"infotel"}},[e._v(e._s(e.checkedAddress.tel))]),e._v(" "),s("div",{staticClass:"addr_location",attrs:{id:"infoaddr"}},[e._v(e._s(e.checkedAddress.province)+e._s(e.checkedAddress.city)+e._s(e.checkedAddress.county)+"（"+e._s(e.checkedAddress.xiaoquName)+"）"+e._s(e.checkedAddress.detailAddress))])]):e._e(),e._v(" "),s("div",{staticClass:"addr-f"},[e._v(" ")])]),e._v(" "),s("div",{staticClass:"product_detail"},[s("img",{staticClass:"product_picture",attrs:{src:e.product.smallPicture}}),e._v(" "),s("div",{staticClass:"product_content"},[s("div",{staticClass:"product_name"},[e._v(e._s(e.product.name))]),e._v(" "),s("div",{staticClass:"product_pri_area"},[s("div",{staticClass:"fl fs16 highlight pt5"},[e._v(" ¥"+e._s(e.rule.price)+" ")]),e._v(" "),s("div",{staticClass:"fl fs13",staticStyle:{"margin-left":"10px","padding-top":"7px",color:"#888888"}},[s("del",[e._v("¥"+e._s(e.product.oriPrice))])])])])]),e._v(" "),s("div",{staticClass:"p15  highlight",staticStyle:{height:"36px"}},[s("span",{staticClass:"fl fs15"},[e._v("支付金额")]),e._v(" "),s("span",{staticClass:"fr fs20 mlr10"},[e._v(" ¥ "+e._s(e.totalAmount)+"  ")])]),e._v(" "),s("div",{staticClass:"btn-fixed"},[s("div",{staticClass:"btn",on:{click:e.pay}},[e._v("立即微信支付")])])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.zzshow,expression:"zzshow"}],staticClass:"zzmb",staticStyle:{display:"none",position:"fixed"},attrs:{id:"zzmb"}})])},staticRenderFns:[]};var p=s("VU/8")(l,v,!1,function(e){s("we/i")},"data-v-62b6a092",null);t.default=p.exports},"we/i":function(e,t){}});