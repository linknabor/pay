webpackJsonp([7],{VqR4:function(e,s){},dGfM:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var o=t("fxnj"),a=t.n(o),n=t("lbHh"),c=t.n(n),r=void 0,u={data:function(){return{zzshow:!1,ruleId:this.$route.query.ruleId,type:this.$route.query.type,product:{},rule:{limitNumOnce:10,price:0},address:{},checkedAddress:{},count:1,totalAmount:0,order:{},couponNum:0,coupon:null,couponDesc:"不使用",coupons:[],couponid:this.$route.query.couponid}},watch:{},created:function(){r=this},mounted:function(){r.roady()},components:{},methods:{initSession4Test:function(){r.receiveData.getData(r,"/initSession4Test/8427","Data",function(){})},roady:function(){r.ruleId&&r.type&&r.queryBuyInfo()},queryBuyInfo:function(){r.receiveData.getData(r,"/queryBuyInfo/"+r.type+"/"+r.ruleId,"res",function(){r.res.success?(r.product=r.res.result.product,r.rule=r.res.result.rule,r.res.result.address&&(r.checkedAddress=r.res.result.address),r.queryCoupon(),r.computeAmount()):alert("订单处理中，请稍后再试！")})},queryCoupon:function(){var e={salePlanType:r.type,itemList:[{ruleId:r.ruleId,count:r.count}]};r.receiveData.postData(r,"/coupon/valid",e,"res",function(){r.res.success?null!=r.res.result&&(r.coupons=r.res.result,r.couponNum=r.coupons.length,r.computeAmount()):alert(r.res.message)})},computeAmount:function(){var e,s;if(e=r.rule.price*r.count,void 0!=r.couponid)for(var t=0;t<r.coupons.length;t++)r.couponid==r.coupons[t].id&&(r.coupon=r.coupons[t]);void 0==r.couponid&&(r.coupon=r.coupons[0],r.couponid=r.coupon.id),null!=r.coupon&&(null==r.coupon.usageCondition||r.coupon.usageCondition>e?(alert("当前优惠券不可用"),r.coupon=null):r.couponDesc="¥ "+r.coupon.amount),null==r.coupon?s=e:r.coupon.amount>0&&(s=e-r.coupon.amount),r.totalAmount=s>0?s.toFixed(2):"0.01"},showCoupons:function(){0!=r.coupons.length&&null!=r.coupons&&r.$router.push({path:"/coupon",name:"coupon",query:{type:r.type,ruleId:r.ruleId,count:r.count,couponid:r.couponid}})},pay:function(){var e={ruleId:r.ruleId,count:r.count,orderType:"12",serviceAddressId:r.checkedAddress.id,payType:"2"};null!=r.coupon&&(e.couponId=r.coupon.id);var s=c.a.get("sectId");if(""==s||"null"==s||0==s||null==s)return alert("您暂未绑定房屋，请前往“我是业主”进行操作，感谢！"),location.href=r.basePageUrl+"wuye/index.html?"+r.common.getoriApp()+"#/myhouse",!1;r.zzshow=!0,r.receiveData.postData(r,"/createOrder",e,"n",function(){r.n.success?(r.order=r.n.result,r.requestPay()):(r.zzshow=!1,alert(null==r.n.message?"订单创建失败，请稍后重试！":r.n.message))})},requestPay:function(){r.receiveData.postData(r,"/requestPay/"+r.order.id,null,"n",function(){r.n.success?(a.a.config({debug:!1,appId:r.n.result.appId,timestamp:r.n.result.timestamp,nonceStr:r.n.result.nonceStr,signature:r.n.result.signature,jsApiList:["chooseWXPay"]}),a.a.chooseWXPay({timestamp:r.n.result.timestamp,nonceStr:r.n.result.nonceStr,package:r.n.result.pkgStr,signType:r.n.result.signType,paySign:r.n.result.signature,success:function(e){r.notifyPaySuccess()},cancel:function(e){alert("支付取消"),r.zzshow=!1}})):(alert(null==r.n.message?"支付请求失败，请稍后重试！":r.n.message),r.zzshow=!1)})},notifyPaySuccess:function(){var e="notifyPayed/"+r.order.id;r.receiveData.getData(r,e,"res",function(){r.res.success?(alert("下单成功！"),r.$router.push({path:"/cardrollsuccess",query:{orderId:r.order.id,type:r.type}})):(r.zzshow=!1,alert(r.res.message))})},cancelPay:function(){r.receiveData.getData(r,"/order/cancelRequestPay/"+r.order.id,"res",function(){r.res.success||alert(r.res.message)})}},computed:{}},i={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"buy"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"load6",attrs:{id:"LoadingBar"}},[t("div",{staticClass:"bounce1"}),e._v(" "),t("div",{staticClass:"bounce2"}),e._v(" "),t("div",{staticClass:"bounce3"})]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"black_overlay",attrs:{id:"fade"}}),e._v(" "),t("div",{staticClass:"zhi"},[t("div",{staticStyle:{background:"white",height:"15px",width:"100%"}},[e._v(" ")]),e._v(" "),t("div",{staticClass:"addr_area"},[t("div",{staticClass:"addr-top"},[e._v(" ")]),e._v(" "),e.checkedAddress.receiveName?t("div",{staticClass:"menu-link fs14 addr_detail"},[t("span",{staticStyle:{color:"#3b3937"},attrs:{id:"infoname"}},[e._v(e._s(e.checkedAddress.receiveName))]),e._v(" "),t("span",{staticStyle:{"margin-left":"15px",color:"#3b3937"},attrs:{id:"infotel"}},[e._v(e._s(e.checkedAddress.tel))]),e._v(" "),t("div",{staticClass:"addr_location",attrs:{id:"infoaddr"}},[e._v(e._s(e.checkedAddress.province)+e._s(e.checkedAddress.city)+e._s(e.checkedAddress.county)+"（"+e._s(e.checkedAddress.xiaoquName)+"）"+e._s(e.checkedAddress.detailAddress))])]):e._e(),e._v(" "),t("div",{staticClass:"addr-f"},[e._v(" ")])]),e._v(" "),t("div",{staticClass:"product_detail"},[t("img",{staticClass:"product_picture",attrs:{src:e.product.smallPicture}}),e._v(" "),t("div",{staticClass:"product_content"},[t("div",{staticClass:"product_name"},[e._v(e._s(e.product.name))]),e._v(" "),t("div",{staticClass:"product_pri_area"},[t("div",{staticClass:"fl fs16 highlight pt5"},[e._v(" ¥"+e._s(e.rule.price)+" ")]),e._v(" "),t("div",{staticClass:"fl fs13",staticStyle:{"margin-left":"10px","padding-top":"7px",color:"#888888"}},[t("del",[e._v("¥"+e._s(e.product.oriPrice))])])])])]),e._v(" "),t("div",{staticClass:"p15 ",on:{click:e.showCoupons}},[t("span",{staticClass:"fl fs15"},[e._v("优惠券")]),e._v(" "),t("span",{staticClass:"fl fs15 baoyou_desc"},[e._v(e._s(e.couponNum)+"张可用")]),e._v(" "),t("span",{staticClass:"fr fs15 mlr10"},[e._v(e._s(e.couponDesc))])]),e._v(" "),t("div",{staticClass:"p15  highlight"},[t("span",{staticClass:"fl fs15"},[e._v("支付金额")]),e._v(" "),t("span",{staticClass:"fr fs15 mlr10"},[e._v(" ¥ "+e._s(e.totalAmount)+"  ")])]),e._v(" "),t("div",{staticClass:"btn-fixed"},[t("div",{staticClass:"btn",on:{click:e.pay}},[e._v("立即微信支付")])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.zzshow,expression:"zzshow"}],staticClass:"zzmb",staticStyle:{display:"none",position:"fixed"},attrs:{id:"zzmb"}})])},staticRenderFns:[]};var d=t("VU/8")(u,i,!1,function(e){t("VqR4")},"data-v-b43c4c08",null);s.default=d.exports}});